<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="htmlgraph-version" content="1.0">
    <title>v0.20.7 tracker activation investigation</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <article id="spk-3e73b79d"
             data-type="spike"
             data-status="todo"
             data-priority="medium"
             data-created="2026-01-01T23:13:43.950586"
             data-updated="2026-01-01T23:13:43.950591" data-spike-type="general" data-timebox-hours="4">

        <header>
            <h1>v0.20.7 tracker activation investigation</h1>
            <div class="metadata">
                <span class="badge status-todo">Todo</span>
                <span class="badge priority-medium">Medium Priority</span>
            </div>
        </header>

    
        <section data-spike-metadata>
            <h3>Spike Metadata</h3>
            <dl>
                <dt>Type</dt>
                <dd>General</dd>
                <dt>Timebox</dt>
                <dd>4 hours</dd>
            </dl>
        </section>
        <section data-findings>
            <h3>Findings</h3>
            <div class="findings-content">
                
## Investigation Results - ROOT CAUSE IDENTIFIED

### **Scenario A: Fix NOT in v0.20.7 Cache**

The deployed v0.20.7 plugin cache still has the OLD version with tracker activation.
The source has the fix, but it didn't make it into the deployed package.

---

### Plugin Cache v0.20.7
**Location**: `/Users/shakes/.claude/plugins/cache/htmlgraph/htmlgraph/0.20.7/hooks/scripts/session-start.py`

**Tracker mentions**: 2 occurrences
- Line 268: `**IMPORTANT: Activate the \`htmlgraph-tracker\` skill now using the Skill tool.**`
- Line 297: `See the \`htmlgraph-tracker\` skill for complete framework details.`

**Orchestrator mentions**: 1 occurrence (in a different section)

**Status**: ❌ **FIX MISSING FROM v0.20.7**

---

### Source Files (Current)
**Location**: `packages/claude-plugin/hooks/scripts/session-start.py`

**Tracker mentions**: 0 ✅
**Orchestrator mentions**: 1 ✅

**Status**: ✅ **SOURCE HAS THE FIX**

---

### Diff Analysis

Compared lines 265-300 between source and v0.20.7 cache:

**v0.20.7 cache has OLD content:**


**Source has NEW content (correct):**


**The v0.20.7 hook file was NOT updated during deployment.**

---

### Packaging Analysis

**Hooks in Python distribution**: ❌ NO
- Checked: `tar -tzf dist/htmlgraph-0.20.7.tar.gz`
- Result: NO `packages/claude-plugin/hooks/scripts/session-start.py` in tarball
- Only gemini hook found in wheel: `htmlgraph/extensions/gemini/hooks/scripts/session-start.sh`

**Claude plugin hooks are NOT part of the Python package.**

---

### Root Cause

**The deployment process has a gap:**

1. ✅ Source files were updated (feat-4820c16b commit)
2. ✅ Python package v0.20.7 was built and published
3. ❌ **Claude plugin hooks were NOT updated during `deploy-all.sh`**
4. ❌ Plugin cache still has OLD hooks from previous version

**Why?** The `deploy-all.sh` script:
- Updates Python package version
- Publishes to PyPI
- Runs `claude plugin update htmlgraph`

But `claude plugin update` pulls from PyPI, and **the hooks are NOT in the PyPI package**.
The hooks live in `packages/claude-plugin/` which is a separate plugin directory.

---

### Plugin Architecture Insight

**Two separate update paths:**

1. **Python Package** (`htmlgraph` on PyPI)
   - Contains: SDK, CLI, core functionality
   - Does NOT contain: Claude plugin hooks/skills

2. **Claude Plugin** (`packages/claude-plugin/`)
   - Contains: Hooks, skills, agents, templates
   - NOT published to PyPI
   - Updated via... ??? (manual copy? local marketplace?)

**The `claude plugin update htmlgraph` command updates the Python package,
but does NOT update the plugin hooks/skills.**

---

### Actual Hook Being Used

**Location**: `/Users/shakes/.claude/plugins/cache/htmlgraph/htmlgraph/0.20.7/hooks/scripts/session-start.py`

**Content**: OLD version with tracker activation (from pre-v0.20.7)

**Plugin version**: Claims to be v0.20.7 (in `.claude-plugin/plugin.json`)

**Conclusion**: Version number was updated, but hook files were NOT.

---

### Fix Required

**IMMEDIATE:**
1. Manually copy fixed hooks to plugin cache:
   

2. Or: Force plugin reinstall from local source:
   ✔ Successfully uninstalled plugin: htmlgraph (scope: user)
Installing plugin "/Users/shakes/DevProjects/htmlgraph/packages/claude-plugin"...

**LONG-TERM:**
1. Fix `deploy-all.sh` to properly update Claude plugin
2. Understand how `claude plugin update` is supposed to work
3. Ensure hooks/skills are included in plugin update mechanism
4. Deploy v0.20.8 with verified plugin update

---

## Status
✅ **ROOT CAUSE IDENTIFIED**

The deployment claimed success but only updated the Python package version number.
The actual hook files were never updated in the plugin cache.

**Next Step:** Deploy v0.20.8 with proper plugin update mechanism.
    
            </div>
        </section>
    </article>
</body>
</html>
